<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Data Gator: include/logging_util.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="alligator_icon_256.png"/></td>
  <td id="projectalign">
   <div id="projectname">Data Gator
   </div>
   <div id="projectbrief">Hardware and software documentation for the Data Gator project.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('logging__util_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">logging_util.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Utilities for logging data.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Preferences.h&gt;</code><br />
<code>#include &lt;NTPClient.h&gt;</code><br />
<code>#include &lt;TimeStamp.hpp&gt;</code><br />
<code>#include &lt;<a class="el" href="SDLogger_8hpp_source.html">SDLogger.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="SDReader_8hpp_source.html">SDReader.hpp</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for logging_util.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="logging__util_8cpp__incl.png" border="0" usemap="#ainclude_2logging__util_8cpp" alt=""/></div>
<map name="ainclude_2logging__util_8cpp" id="ainclude_2logging__util_8cpp">
<area shape="rect" title="Utilities for logging data." alt="" coords="171,5,347,31"/>
<area shape="rect" title=" " alt="" coords="10,79,121,104"/>
<area shape="poly" title=" " alt="" coords="229,33,110,76,109,71,227,28"/>
<area shape="rect" title=" " alt="" coords="5,225,104,251"/>
<area shape="poly" title=" " alt="" coords="250,33,77,216,73,213,246,29"/>
<area shape="rect" href="TimeStamp_8hpp_source.html" title=" " alt="" coords="196,152,321,177"/>
<area shape="poly" title=" " alt="" coords="261,31,261,138,256,138,256,31"/>
<area shape="rect" href="SDLogger_8hpp.html" title="Implements an interface for using SPI, SDLogger, for reading and writing to files on an SD card." alt="" coords="1238,152,1349,177"/>
<area shape="poly" title=" " alt="" coords="341,28,1224,151,1224,156,340,33"/>
<area shape="rect" href="SDReader_8hpp.html" title="Defines the utility class SDReader which is used to read from SD card files." alt="" coords="483,79,597,104"/>
<area shape="poly" title=" " alt="" coords="305,28,482,73,481,78,303,33"/>
<area shape="poly" title=" " alt="" coords="227,180,101,223,100,218,225,175"/>
<area shape="rect" title=" " alt="" coords="211,225,299,251"/>
<area shape="poly" title=" " alt="" coords="261,178,259,212,253,212,255,178"/>
<area shape="rect" title=" " alt="" coords="323,225,381,251"/>
<area shape="poly" title=" " alt="" coords="275,175,328,215,324,219,272,179"/>
<area shape="rect" title=" " alt="" coords="128,225,187,251"/>
<area shape="poly" title=" " alt="" coords="244,180,187,219,184,215,241,175"/>
<area shape="rect" title=" " alt="" coords="1306,299,1358,324"/>
<area shape="poly" title=" " alt="" coords="1349,164,1384,170,1421,180,1455,198,1482,224,1489,240,1486,255,1475,268,1459,279,1416,295,1372,306,1371,301,1415,290,1456,274,1472,264,1481,253,1484,241,1478,227,1452,202,1419,185,1383,175,1349,170"/>
<area shape="rect" href="SDCard_8hpp.html" title="SDCard Interface Utilities." alt="" coords="1207,225,1380,251"/>
<area shape="poly" title=" " alt="" coords="1296,178,1296,212,1291,212,1291,178"/>
<area shape="rect" title=" " alt="" coords="1405,225,1467,251"/>
<area shape="poly" title=" " alt="" coords="1317,175,1402,217,1399,221,1315,180"/>
<area shape="poly" title=" " alt="" coords="1302,250,1322,285,1317,288,1297,252"/>
<area shape="rect" title=" " alt="" coords="1227,299,1282,324"/>
<area shape="poly" title=" " alt="" coords="1289,252,1270,288,1265,285,1285,250"/>
<area shape="poly" title=" " alt="" coords="495,107,318,151,317,146,494,101"/>
<area shape="poly" title=" " alt="" coords="495,106,447,125,423,138,402,154,379,183,363,214,358,211,374,180,398,150,420,134,445,120,493,102"/>
<area shape="poly" title=" " alt="" coords="597,95,1224,154,1224,159,597,101"/>
<area shape="poly" title=" " alt="" coords="525,106,491,134,455,172,442,192,435,212,436,231,446,249,463,260,493,269,584,282,703,289,839,292,1109,292,1218,293,1292,297,1292,302,1218,298,1109,298,839,297,703,294,583,287,492,274,461,264,442,253,430,233,430,211,437,190,451,168,487,130,522,102"/>
<area shape="poly" title=" " alt="" coords="598,101,1221,220,1220,225,597,106"/>
<area shape="poly" title=" " alt="" coords="597,97,930,142,1157,179,1392,223,1391,228,1156,184,929,148,596,102"/>
<area shape="rect" href="MQTTMailer_8hpp_source.html" title=" " alt="" coords="647,152,775,177"/>
<area shape="poly" title=" " alt="" coords="568,102,671,144,669,149,566,106"/>
<area shape="rect" title=" " alt="" coords="759,225,879,251"/>
<area shape="poly" title=" " alt="" coords="729,175,791,215,788,220,727,180"/>
<area shape="rect" title=" " alt="" coords="903,225,1047,251"/>
<area shape="poly" title=" " alt="" coords="754,175,919,219,918,224,752,180"/>
<area shape="rect" title=" " alt="" coords="1071,225,1182,251"/>
<area shape="poly" title=" " alt="" coords="775,174,1058,222,1057,228,774,180"/>
<area shape="rect" title=" " alt="" coords="457,225,567,251"/>
<area shape="poly" title=" " alt="" coords="680,180,558,223,557,218,678,175"/>
<area shape="rect" title=" " alt="" coords="591,225,734,251"/>
<area shape="poly" title=" " alt="" coords="705,179,680,216,676,213,701,176"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="logging__util_8cpp__dep__incl.png" border="0" usemap="#ainclude_2logging__util_8cppdep" alt=""/></div>
<map name="ainclude_2logging__util_8cppdep" id="ainclude_2logging__util_8cppdep">
<area shape="rect" title="Utilities for logging data." alt="" coords="5,5,181,31"/>
<area shape="rect" href="src_2main_8cpp.html" title="Initializes device and calls routines." alt="" coords="41,79,146,104"/>
<area shape="poly" title=" " alt="" coords="96,44,96,79,91,79,91,44"/>
</map>
</div>
</div>
<p><a href="logging__util_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a27e949dc420cd22ef8c220d82cc8259f" id="r_a27e949dc420cd22ef8c220d82cc8259f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#a27e949dc420cd22ef8c220d82cc8259f">cache_retrieve_timestamp</a> ()</td></tr>
<tr class="separator:a27e949dc420cd22ef8c220d82cc8259f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84557373ab4c41663554890c5589bc3c" id="r_a84557373ab4c41663554890c5589bc3c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#a84557373ab4c41663554890c5589bc3c">cache_timestamp</a> (<a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> timestamp)</td></tr>
<tr class="separator:a84557373ab4c41663554890c5589bc3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae48655ee393afdbed2a929b09c9a724a" id="r_ae48655ee393afdbed2a929b09c9a724a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#ae48655ee393afdbed2a929b09c9a724a">init_data_logger</a> ()</td></tr>
<tr class="memdesc:ae48655ee393afdbed2a929b09c9a724a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize logging interfaces.  <br /></td></tr>
<tr class="separator:ae48655ee393afdbed2a929b09c9a724a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55a2c93667516d15e039732826250596" id="r_a55a2c93667516d15e039732826250596"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#a55a2c93667516d15e039732826250596">get_log_filename</a> (<a class="el" href="classTimeStampParser.html">TimeStampParser</a> *)</td></tr>
<tr class="separator:a55a2c93667516d15e039732826250596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b87f9c41c4be140985330e569dcc999" id="r_a9b87f9c41c4be140985330e569dcc999"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#a9b87f9c41c4be140985330e569dcc999">log_to_sd_file</a> (<a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> filename, <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">time</a>, <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> topic, <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> message)</td></tr>
<tr class="separator:a9b87f9c41c4be140985330e569dcc999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0288d721e9a933c0494590b09c7d810" id="r_aa0288d721e9a933c0494590b09c7d810"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#aa0288d721e9a933c0494590b09c7d810">cache_log_offset</a> (<a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">int</a> <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">log_offset</a>)</td></tr>
<tr class="separator:aa0288d721e9a933c0494590b09c7d810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc8f9c3ac6f2042bc5fc8660063aad5e" id="r_abc8f9c3ac6f2042bc5fc8660063aad5e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#abc8f9c3ac6f2042bc5fc8660063aad5e">cache_retrieve_log_offset</a> (<a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a>)</td></tr>
<tr class="separator:abc8f9c3ac6f2042bc5fc8660063aad5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8d97b37dcabe2cc9a8a3452672449bf" id="r_ac8d97b37dcabe2cc9a8a3452672449bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#ac8d97b37dcabe2cc9a8a3452672449bf">log_to_sd_file</a> (<a class="el" href="classSDLogger.html">SDLogger</a> *<a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">l</a>, <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">time</a>, <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> topic, <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> message)</td></tr>
<tr class="separator:ac8d97b37dcabe2cc9a8a3452672449bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:add9553c173198049d23f8a89fe11142c" id="r_add9553c173198049d23f8a89fe11142c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">Preferences</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#add9553c173198049d23f8a89fe11142c">gator_prefs</a></td></tr>
<tr class="memdesc:add9553c173198049d23f8a89fe11142c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to non-volatile-storage on ESP32.  <br /></td></tr>
<tr class="separator:add9553c173198049d23f8a89fe11142c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618f91fbc4c35bde353fc1732d389a69" id="r_a618f91fbc4c35bde353fc1732d389a69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#a618f91fbc4c35bde353fc1732d389a69">logging_available</a> = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">false</a></td></tr>
<tr class="memdesc:a618f91fbc4c35bde353fc1732d389a69"><td class="mdescLeft">&#160;</td><td class="mdescRight">is some logging interface available?  <br /></td></tr>
<tr class="separator:a618f91fbc4c35bde353fc1732d389a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b73c0ce5c9049c6073dc70fc9bb227" id="r_ac0b73c0ce5c9049c6073dc70fc9bb227"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#ac0b73c0ce5c9049c6073dc70fc9bb227">absolute_timestamp_available</a> = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">false</a></td></tr>
<tr class="memdesc:ac0b73c0ce5c9049c6073dc70fc9bb227"><td class="mdescLeft">&#160;</td><td class="mdescRight">is an exact/accurate timestamp available?  <br /></td></tr>
<tr class="separator:ac0b73c0ce5c9049c6073dc70fc9bb227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f9cf039424a99aff815f1fbb03eb9ca" id="r_a0f9cf039424a99aff815f1fbb03eb9ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#a0f9cf039424a99aff815f1fbb03eb9ca">logged_relative_data</a> = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">false</a></td></tr>
<tr class="memdesc:a0f9cf039424a99aff815f1fbb03eb9ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">relatively accurate timestamp used, last exact timestamp + # of minutes/resets elapsed <br  />
  <br /></td></tr>
<tr class="separator:a0f9cf039424a99aff815f1fbb03eb9ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437b44d29a55b718c85988d982c0f809" id="r_a437b44d29a55b718c85988d982c0f809"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="logging__util_8cpp.html#a437b44d29a55b718c85988d982c0f809">time_stamp_to_cache</a> = &quot;&quot;</td></tr>
<tr class="memdesc:a437b44d29a55b718c85988d982c0f809"><td class="mdescLeft">&#160;</td><td class="mdescRight">the formatted timestamp to write to non-volatile memory for next reset  <br /></td></tr>
<tr class="separator:a437b44d29a55b718c85988d982c0f809"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a446e0ace32278a3a0ee36f498eb24e04" id="r_a446e0ace32278a3a0ee36f498eb24e04"><td class="memItemLeft" align="right" valign="top"><a id="a446e0ace32278a3a0ee36f498eb24e04" name="a446e0ace32278a3a0ee36f498eb24e04"></a>
<a class="el" href="classSDLogger.html">SDLogger</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>logger</b> = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">NULL</a></td></tr>
<tr class="memdesc:a446e0ace32278a3a0ee36f498eb24e04"><td class="mdescLeft">&#160;</td><td class="mdescRight">reads and writes to files <br /></td></tr>
<tr class="separator:a446e0ace32278a3a0ee36f498eb24e04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9af592e268390420308fbf5e719d393a" id="r_a9af592e268390420308fbf5e719d393a"><td class="memItemLeft" align="right" valign="top"><a id="a9af592e268390420308fbf5e719d393a" name="a9af592e268390420308fbf5e719d393a"></a>
<a class="el" href="classTimeStampBuilder.html">TimeStampBuilder</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>tsb</b> = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">NULL</a></td></tr>
<tr class="memdesc:a9af592e268390420308fbf5e719d393a"><td class="mdescLeft">&#160;</td><td class="mdescRight">builds timestamp strings <br /></td></tr>
<tr class="separator:a9af592e268390420308fbf5e719d393a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a059cc83bd876c61f940532a2008071e3" id="r_a059cc83bd876c61f940532a2008071e3"><td class="memItemLeft" align="right" valign="top"><a id="a059cc83bd876c61f940532a2008071e3" name="a059cc83bd876c61f940532a2008071e3"></a>
<a class="el" href="classTimeStampParser.html">TimeStampParser</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>tsp</b> = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">NULL</a></td></tr>
<tr class="memdesc:a059cc83bd876c61f940532a2008071e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">parses timestamp strings <br /></td></tr>
<tr class="separator:a059cc83bd876c61f940532a2008071e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utilities for logging data. </p>
<h1><a class="anchor" id="autotoc_md2"></a>
Summary</h1>
<p>Define the helper functions/utilities which have been written for logging data on the Data Gators.</p>
<p>Emphasis is placed on making this as simple to use as possible. Unfortunately it is likely that the implementation is rather difficult to follow due to the number of edge cases covered. These include:</p>
<ul>
<li>multiple logging <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8" title="number of resets retrieved for NVS">interfaces(SD, WiFi, etc)</a></li>
<li>cases where network connection is not available to obtain timestamp for data</li>
</ul>
<h3><a class="anchor" id="autotoc_md3"></a>
Key Functionality</h3>
<p>Key functionality includes functions for:</p>
<ol type="1">
<li>caching and retreiving data from NVS<ul>
<li>timestamps</li>
<li>log offsets (calculated from # of resets)</li>
</ul>
</li>
<li>constructing file names for logging</li>
<li>logging to SD card file</li>
</ol>
<dl class="section author"><dt>Author</dt><dd>Garrett Wells </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa0288d721e9a933c0494590b09c7d810" name="aa0288d721e9a933c0494590b09c7d810"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0288d721e9a933c0494590b09c7d810">&#9670;&#160;</a></span>cache_log_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a> cache_log_offset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">int</a>&#160;</td>
          <td class="paramname"><em>log_offset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Save the reset count.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">log_offset</td><td>The offset in ticks. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc8f9c3ac6f2042bc5fc8660063aad5e" name="abc8f9c3ac6f2042bc5fc8660063aad5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc8f9c3ac6f2042bc5fc8660063aad5e">&#9670;&#160;</a></span>cache_retrieve_log_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">int</a> cache_retrieve_log_offset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the reset count.</p>
<dl class="section return"><dt>Returns</dt><dd>Number of resets/times the device as booted. </dd></dl>

</div>
</div>
<a id="a27e949dc420cd22ef8c220d82cc8259f" name="a27e949dc420cd22ef8c220d82cc8259f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27e949dc420cd22ef8c220d82cc8259f">&#9670;&#160;</a></span>cache_retrieve_timestamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> cache_retrieve_timestamp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve time stamp from non-volatile memory so that it can be used for log file access.</p>
<dl class="section return"><dt>Returns</dt><dd>The string value stored in non-volatile memory, should be expected to be of format produced by <a class="el" href="classTimeStampBuilder.html">TimeStampBuilder</a> </dd></dl>

</div>
</div>
<a id="a84557373ab4c41663554890c5589bc3c" name="a84557373ab4c41663554890c5589bc3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84557373ab4c41663554890c5589bc3c">&#9670;&#160;</a></span>cache_timestamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a> cache_timestamp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td>
          <td class="paramname"><em>timestamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cache/update the last known absolute timestamp from the NTPClient to non-volatile memory</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">timestamp</td><td>A timestamp string following the syntax of <a class="el" href="classTimeStampBuilder.html">TimeStampBuilder</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a55a2c93667516d15e039732826250596" name="a55a2c93667516d15e039732826250596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55a2c93667516d15e039732826250596">&#9670;&#160;</a></span>get_log_filename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> get_log_filename </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTimeStampParser.html">TimeStampParser</a> *&#160;</td>
          <td class="paramname"><em>tsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate a file name based on the current time stamp. Should only be called if <a class="el" href="classTimeStampBuilder.html">TimeStampBuilder</a> has been updated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tsp</td><td><a class="el" href="classTimeStampParser.html">TimeStampParser</a> which defines parser for reading the current time stamp from a string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a constructed filename <code>log_&lt;month&gt;-&lt;day&gt;-&lt;year&gt;</code> </dd></dl>

</div>
</div>
<a id="ae48655ee393afdbed2a929b09c9a724a" name="ae48655ee393afdbed2a929b09c9a724a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae48655ee393afdbed2a929b09c9a724a">&#9670;&#160;</a></span>init_data_logger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">bool</a> init_data_logger </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize logging interfaces. </p>
<p>Perform all initialization necessary before logging any data with log_message to the uSD card.</p>
<dl class="section return"><dt>Returns</dt><dd>bool true if successfully initialized, false for:<ul>
<li>no SD card detected</li>
<li>some other potential error </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ac8d97b37dcabe2cc9a8a3452672449bf" name="ac8d97b37dcabe2cc9a8a3452672449bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8d97b37dcabe2cc9a8a3452672449bf">&#9670;&#160;</a></span>log_to_sd_file() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a> log_to_sd_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSDLogger.html">SDLogger</a> *&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write an MQTT message to a file on the SD card. Requires a time stamp and filename.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td>The <a class="el" href="classSDLogger.html" title="Creates an interface for writing data to a log file on an SD card.">SDLogger</a> instance with all filename and separator information pre-set</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>The time hr:min:sec+offset that will be written to the log file</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>The mqtt topic the data should have been logged to</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>The mqtt message containing the data we want to save </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9b87f9c41c4be140985330e569dcc999" name="a9b87f9c41c4be140985330e569dcc999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b87f9c41c4be140985330e569dcc999">&#9670;&#160;</a></span>log_to_sd_file() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">void</a> log_to_sd_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a>&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write an MQTT message to a file on the SD card. Requires a time stamp and filename.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>The string file name to log the topic and message to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>string time, formatted according to <a class="el" href="classTimeStampBuilder.html">TimeStampBuilder</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>The topic, according to MQTT format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>The message which contains data. Often JSON object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac0b73c0ce5c9049c6073dc70fc9bb227" name="ac0b73c0ce5c9049c6073dc70fc9bb227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0b73c0ce5c9049c6073dc70fc9bb227">&#9670;&#160;</a></span>absolute_timestamp_available</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">bool</a> absolute_timestamp_available = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">false</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>is an exact/accurate timestamp available? </p>
<p>Flag set during initialization, indicates that WiFi connection to NTP for update was obtained. </p>

</div>
</div>
<a id="add9553c173198049d23f8a89fe11142c" name="add9553c173198049d23f8a89fe11142c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9553c173198049d23f8a89fe11142c">&#9670;&#160;</a></span>gator_prefs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">Preferences</a> gator_prefs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reference to non-volatile-storage on ESP32. </p>
<p>Reference to non-volatile-storage on ESP32.</p>
<p>NVS memory access interface. </p>

</div>
</div>
<a id="a0f9cf039424a99aff815f1fbb03eb9ca" name="a0f9cf039424a99aff815f1fbb03eb9ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f9cf039424a99aff815f1fbb03eb9ca">&#9670;&#160;</a></span>logged_relative_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">bool</a> logged_relative_data = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">false</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>relatively accurate timestamp used, last exact timestamp + # of minutes/resets elapsed <br  />
 </p>
<p>Flag set to indicate that no network connection was available for NTP update to get precise timestamp. </p>

</div>
</div>
<a id="a618f91fbc4c35bde353fc1732d389a69" name="a618f91fbc4c35bde353fc1732d389a69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a618f91fbc4c35bde353fc1732d389a69">&#9670;&#160;</a></span>logging_available</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">bool</a> logging_available = <a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">false</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>is some logging interface available? </p>
<p>Flag showing that some logging interface is available. May be uSD card or MQTT. </p>

</div>
</div>
<a id="a437b44d29a55b718c85988d982c0f809" name="a437b44d29a55b718c85988d982c0f809"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437b44d29a55b718c85988d982c0f809">&#9670;&#160;</a></span>time_stamp_to_cache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2main_8cpp.html#a2df27a00b191de3537c3b53adcecf1e8">std::string</a> time_stamp_to_cache = &quot;&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the formatted timestamp to write to non-volatile memory for next reset </p>
<p>The timestamp, last exact timestamp + offset to write to non-volatile storage. This timestamp will be retrieved on next reset and replaced if network connection to NTP available. If NTP not available, then the offset is incremented. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="logging__util_8cpp.html">logging_util.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
